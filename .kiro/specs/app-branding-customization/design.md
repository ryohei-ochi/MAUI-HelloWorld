# 設計文書

## 概要

この設計文書では、.NET MAUIアプリケーションにおけるアプリアイコンとスプラッシュスクリーンのカスタマイズ機能の実装方法を定義します。MacCatalystを対象プラットフォームから除外し、Android、iOS、Windowsプラットフォームでのブランディング要素のカスタマイズを実現します。

## アーキテクチャ

### プラットフォーム構成
- **対象プラットフォーム**: Android (net8.0-android), iOS (net8.0-ios), Windows (net8.0-windows10.0.19041.0)
- **除外プラットフォーム**: MacCatalyst (net8.0-maccatalyst)
- **リソース管理**: .NET MAUIの統合リソースシステムを使用

### リソース構造
```
Resources/
├── AppIcon/
│   ├── appicon.svg (メインアイコン)
│   └── appiconfg.svg (フォアグラウンドアイコン)
└── Splash/
    └── splash.svg (スプラッシュスクリーン画像)
```

## コンポーネントとインターフェース

### 1. プロジェクト設定コンポーネント
**責任**: プラットフォーム設定とリソース定義の管理

**設定項目**:
- TargetFrameworks: MacCatalystを除外した対象プラットフォームの定義
- MauiIcon: アプリアイコンの設定
- MauiSplashScreen: スプラッシュスクリーンの設定

### 2. アプリアイコンコンポーネント
**責任**: カスタムアプリアイコンの生成と配布

**主要機能**:
- SVGベースのアダプティブアイコン生成
- プラットフォーム固有のアイコンサイズ自動生成
- フォアグラウンド/バックグラウンド分離サポート

**設定パラメータ**:
- Include: アイコンファイルパス
- ForegroundFile: フォアグラウンドファイルパス（オプション）
- Color: 背景色

### 3. スプラッシュスクリーンコンポーネント
**責任**: カスタムスプラッシュスクリーンの生成と表示

**主要機能**:
- SVGベースのスプラッシュスクリーン生成
- 背景色のカスタマイズ
- 画面サイズ適応
- プラットフォーム固有リソース生成

**設定パラメータ**:
- Include: スプラッシュ画像ファイルパス
- Color: 背景色
- BaseSize: ベースサイズ

## データモデル

### プロジェクト設定モデル
```xml
<PropertyGroup>
    <TargetFrameworks>net8.0-android;net8.0-ios;net8.0-windows10.0.19041.0</TargetFrameworks>
    <!-- MacCatalyst除外 -->
</PropertyGroup>

<ItemGroup>
    <!-- アプリアイコン設定 -->
    <MauiIcon Include="Resources\AppIcon\appicon.svg" 
              ForegroundFile="Resources\AppIcon\appiconfg.svg" 
              Color="#512BD4" />
    
    <!-- スプラッシュスクリーン設定 -->
    <MauiSplashScreen Include="Resources\Splash\splash.svg" 
                      Color="#512BD4" 
                      BaseSize="128,128" />
</ItemGroup>
```

### リソースファイル仕様
- **アイコンファイル**: SVG形式、推奨サイズ 512x512px
- **スプラッシュファイル**: SVG形式、アスペクト比を考慮したデザイン
- **色指定**: 16進数カラーコード (#RRGGBB形式)

## エラーハンドリング

### ビルド時エラー処理
1. **リソースファイル不足**:
   - エラーメッセージ: 指定されたリソースファイルが見つからない場合
   - 対処: ファイルパスの確認とファイル存在チェック

2. **無効なSVGファイル**:
   - エラーメッセージ: SVGファイルの形式が無効な場合
   - 対処: SVGファイルの構文チェックと修正

3. **プラットフォーム設定エラー**:
   - エラーメッセージ: 対象プラットフォームの設定が無効な場合
   - 対処: TargetFrameworksの設定確認

### 実行時エラー処理
1. **リソース読み込みエラー**:
   - 代替リソースの使用
   - デフォルトアイコン/スプラッシュスクリーンへのフォールバック

## テスト戦略

### 単体テスト
- プロジェクト設定の検証
- リソースファイルの存在確認
- 設定値の妥当性チェック

### 統合テスト
- ビルドプロセスの検証
- 各プラットフォームでのリソース生成確認
- アイコンとスプラッシュスクリーンの表示確認

### プラットフォーム別テスト
1. **Android**:
   - アダプティブアイコンの表示確認
   - 異なる画面密度での表示確認
   - スプラッシュスクリーンの表示タイミング確認

2. **iOS**:
   - アプリアイコンの表示確認
   - 異なるデバイスサイズでの表示確認
   - Launch Screenの表示確認

3. **Windows**:
   - アプリアイコンの表示確認
   - スタートメニューでの表示確認
   - スプラッシュスクリーンの表示確認

### 検証項目
- MacCatalystが対象から除外されていることの確認
- カスタムアイコンが各プラットフォームで正しく表示されること
- カスタムスプラッシュスクリーンが適切なタイミングで表示されること
- ビルドプロセスがエラーなく完了すること
- 生成されたリソースが適切なサイズと形式であること

## 実装上の考慮事項

### パフォーマンス
- SVGファイルサイズの最適化
- ビルド時間への影響最小化
- リソース生成の効率化

### 保守性
- リソースファイルの命名規則統一
- 設定の集約化
- ドキュメント化

### 拡張性
- 将来的な新プラットフォーム対応
- 追加ブランディング要素への対応
- 動的リソース変更への対応